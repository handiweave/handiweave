<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SEWM8S3WL0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-SEWM8S3WL0');
    </script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#7A5548">

    <title>Handiweave | Traditions and Trends</title>
    <meta name="description" content="Handiweave: Traditions and Trends. A platform empowering Himachal's artisans to market authentic handmade handloom and handicrafts. From Palampur to the world, supporting local heritage directly.">
    <meta name="keywords" content="Handiweave, Himachal Handloom, Kullu Shawls, Artisan Platform, Palampur, Handmade Crafts, Traditions and Trends">
    <link rel="canonical" href="https://handiweave.com/">

    <link rel="icon" type="image/png" href="favicon.png">

    <meta property="og:title" content="Handiweave | Traditions and Trends">
    <meta property="og:description" content="Discover the warmth of Himalayas. 100% Handwoven Shawls, Stoles & Caps from Palampur.">
    <meta property="og:image" content="https://handiweave.com/logo.png">
    <meta property="og:url" content="https://handiweave.com">
    <meta property="og:type" content="website">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Handiweave",
      "url": "https://handiweave.com",
      "logo": "https://handiweave.com/logo.png",
      "description": "A platform empowering Himachal's artisans to market authentic handmade handloom and handicrafts.",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Tehsil Palampur",
        "addressLocality": "District Kangra",
        "addressRegion": "Himachal Pradesh",
        "postalCode": "176060",
        "addressCountry": "IN"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+91-9882212962",
        "contactType": "Customer Support"
      },
      "identifier": {
        "@type": "PropertyValue",
        "name": "MSME Registration",
        "value": "Registered under MSME, Govt. of India"
      },
      "sameAs": [
        "https://instagram.com/handiweave",
        "https://x.com/handiweave"
      ]
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg: #F9F8F6; --card: #fff; --text: #333; --brand: #7A5548; --brand-dark: #5D433A;
            --gold: #C5A065; --wa: #25D366; --rzp: #3395ff; --radius: 8px; --transition: all 0.3s ease;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Lato', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }

        /* ===== HERO HIDING ===== */
        body.hide-hero .hero-section { display: none; }
        body.hide-hero .main-nav { margin-top: 0; }

        /* ===== SHARE BUTTON & REVIEWS ===== */
        .action-buttons { display: flex; gap: 10px; margin-top: 1rem; }
        .share-btn { flex: 1; background: white; border: 1px solid var(--brand); color: var(--brand); padding: 15px; border-radius: 4px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: var(--transition); }
        .share-btn:hover { background: #f9f9f9; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .review-section { margin-top: 2rem; padding-top: 1.5rem; border-top: 1px dashed #ccc; }
        .review-title { font-size: 1.1rem; font-weight: bold; margin-bottom: 1rem; color: var(--brand-dark); display: flex; align-items: center; gap: 8px; }
        .review-card { background: #fff; padding: 12px; border-radius: 6px; margin-bottom: 10px; border: 1px solid #eee; font-size: 0.95rem; }
        .review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; font-weight: 700; color: var(--text); }
        .stars { color: #FFD700; font-size: 0.9rem; }

        /* ===== UTILITIES ===== */
        .trust-banner { background: var(--brand); color: white; padding: 8px; font-size: 0.75rem; text-align: center; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; font-weight: 600; letter-spacing: 0.5px; z-index: 1002; position: relative; }

        /* ===== HERO SECTION ===== */
        @keyframes slideshowFade { 0% { opacity: 0; } 20% { opacity: 1; } 60% { opacity: 1; } 100% { opacity: 0; } }
        .hero-section { min-height: 60vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; color: white; padding: 2rem 1rem; position: relative; overflow: hidden; }
        .hero-section::before, .hero-section::after { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-size: cover; background-position: center; opacity: 0; animation: slideshowFade 12s infinite ease-in-out; }
        .hero-section::before { background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('ar3.jpg'); animation-delay: 0s; }
        .hero-section::after { background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('ar2.jpg'); animation-delay: 6s; }
        .hero-logo-container { margin-bottom: 1rem; animation: fadeInDown 1s ease; }
        .hero-logo { width: 130px; height: 130px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; box-shadow: 0 8px 25px rgba(0,0,0,0.4); border: 3px solid var(--gold); padding: 10px; }
        .hero-logo img { width: 90px; height: auto; object-fit: contain; }
        .hero-title { font-family: 'Playfair Display', serif; font-size: 3rem; letter-spacing: 3px; margin-bottom: 0.5rem; font-weight: 700; text-shadow: 2px 2px 8px rgba(0,0,0,0.6); }
        .hero-tagline { color: var(--gold); font-style: italic; font-size: 1.1rem; margin-bottom: 1.5rem; letter-spacing: 1px; text-shadow: 1px 1px 4px rgba(0,0,0,0.8); }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        /* ===== NAV ===== */
        .main-nav { background: white; padding: 1rem; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 15px rgba(0,0,0,0.05); display: flex; justify-content: center; align-items: center; gap: 1.5rem; flex-wrap: wrap; margin-top: 0; }
        .nav-link { font-size: 0.8rem; font-weight: 700; text-transform: uppercase; cursor: pointer; color: var(--text); letter-spacing: 1px; }
        .nav-link.active { color: var(--brand); border-bottom: 2px solid var(--gold); }
        .search-container { position: relative; display: flex; align-items: center; border: 1px solid #ddd; border-radius: 20px; padding: 5px 15px; background: #fff; margin-right: 15px; }
        .search-container input { border: none; outline: none; font-size: 0.9rem; width: 140px; padding: 5px; }
        .search-container i { color: var(--brand); cursor: pointer; }

        /* ===== CART ICON ===== */
        .cart-icon { position: fixed; top: 1rem; right: 1rem; background: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; color: var(--brand); box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 1001; cursor: pointer; }
        .cart-count { position: absolute; top: -5px; right: -5px; background: var(--brand); color: white; width: 20px; height: 20px; border-radius: 50%; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: 700; }

        /* ===== PRODUCTS ===== */
        .section-container { max-width: 1200px; margin: 0 auto; padding: 3rem 1rem; display: none; }
        .active-section { display: block; }
        .category-filters { display: flex; justify-content: center; gap: 10px; margin-bottom: 2rem; flex-wrap: wrap; }
        .filter-btn { padding: 8px 16px; border: 1px solid var(--brand); background: transparent; color: var(--brand); border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: var(--transition); }
        .filter-btn.active, .filter-btn:hover { background: var(--brand); color: white; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 2rem; }
        .product-card { background: white; border-radius: var(--radius); overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: var(--transition); position: relative; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .product-image { height: 280px; overflow: hidden; position: relative; cursor: pointer; background: white; display: flex; align-items: center; justify-content: center; }
        .product-image img { width: 100%; height: 100%; object-fit: contain; transition: transform 0.5s ease; }
        .product-card:hover .product-image img { transform: scale(1.05); }
        .product-info { padding: 1rem; text-align: center; }
        .product-name { font-weight: 600; margin-bottom: 0.5rem; font-size: 1rem; height: 40px; overflow: hidden; }
        .product-price { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; color: var(--brand); }
        .original-price { text-decoration: line-through; color: #999; font-size: 0.9rem; margin-right: 5px; font-weight: 400; }
        .discount-badge { position: absolute; top: 10px; left: 10px; background: #e74c3c; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; z-index: 10; }
        .sold-out-badge { position: absolute; top: 10px; right: 10px; background: #555; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; z-index: 10; }
        .add-to-cart-btn { background: var(--brand); color: white; padding: 10px; width: 100%; border-radius: 4px; border: none; font-weight: 600; cursor: pointer; transition: var(--transition); }
        .add-to-cart-btn:hover { background: var(--brand-dark); }
        .add-to-cart-btn:disabled { background: #ccc; cursor: not-allowed; }

        /* ===== MODAL ===== */
        .product-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2002; display: none; justify-content: center; align-items: center; padding: 1rem; }
        .product-modal-content { background: white; width: 100%; max-width: 900px; max-height: 90vh; border-radius: 12px; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; padding: 2rem; position: relative; }
        .modal-gallery { display: flex; flex-direction: column; gap: 10px; }
        .main-modal-img { width: 100%; border-radius: 8px; height: 400px; object-fit: contain; background: #f9f9f9; }
        .thumb-grid { display: flex; gap: 10px; overflow-x: auto; }
        .thumb-img { width: 60px; height: 60px; object-fit: contain; border-radius: 4px; cursor: pointer; border: 2px solid #eee; background: white; }
        .thumb-img:hover { border-color: var(--brand); }
        .modal-details h2 { color: var(--brand-dark); margin-bottom: 5px; }
        .modal-price { font-size: 1.5rem; font-weight: bold; color: var(--brand); margin: 10px 0; }
        .variant-selector { margin: 1.5rem 0; background: #f9f9f9; padding: 10px; border-radius: 4px; }
        .variant-selector label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
        .variant-selector select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        .modal-short-desc { font-style: italic; color: #666; margin-bottom: 1rem; border-left: 3px solid var(--gold); padding-left: 10px; }
        .modal-desc { font-size: 0.95rem; color: #333; margin-bottom: 1rem; white-space: pre-wrap; line-height: 1.6; }
        .modal-care { font-size: 0.85rem; color: #555; background: #f1f1f1; padding: 12px; border-radius: 4px; margin-top: 1rem; border: 1px solid #ddd; }
        .modal-close-btn { position: absolute; top: 15px; right: 20px; font-size: 2rem; border: none; background: none; cursor: pointer; color: #666; }

        /* ===== SECTIONS ===== */
        .craft-section { background: white; }
        .craft-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .craft-card { text-align: center; padding: 2rem; background: var(--bg); border-radius: var(--radius); }
        .craft-icon { font-size: 2.5rem; color: var(--brand); margin-bottom: 1rem; }
        .craft-card h3 { margin-bottom: 1rem; color: var(--brand-dark); }
        .story-container { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start; margin-top: 2rem; }
        .story-image { border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .story-image img { width: 100%; height: auto; display: block; }
        .story-content h2 { margin-bottom: 1.5rem; color: var(--brand-dark); }
        .story-text { line-height: 1.8; }
        .highlight-quote { font-style: italic; color: var(--brand); border-left: 3px solid var(--gold); padding-left: 1rem; margin: 1.5rem 0; font-size: 1.1rem; }
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 2rem; }
        .gallery-grid img { width: 100%; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* ===== CONTACT & POLICIES ===== */
        .contact-form { max-width: 600px; margin: 2rem auto 0; background: white; padding: 2rem; border-radius: var(--radius); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .form-group { margin-bottom: 1.5rem; }
        .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; }
        .submit-btn { background: var(--brand); color: white; padding: 14px; width: 100%; border-radius: 4px; border: none; font-weight: 700; cursor: pointer; }
        .policy-accordion { max-width: 800px; margin: 2rem auto 0; }
        .policy-item { background: white; margin-bottom: 1rem; border-radius: var(--radius); overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.05); }
        .policy-header { padding: 1rem 1.5rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 700; background: var(--bg); }
        .policy-content { padding: 0 1.5rem; max-height: 0; overflow: hidden; transition: all 0.3s ease; }
        .policy-content.active { padding: 1.5rem; max-height: 500px; }

        /* ===== CHECKOUT ===== */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1999; display: none; }
        .overlay.active { display: block; }
        .checkout-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 95%; max-width: 500px; background: white; z-index: 2100; border-radius: 12px; padding: 2rem; display: none; box-shadow: 0 20px 40px rgba(0,0,0,0.3); max-height: 90vh; overflow-y: auto; }
        .checkout-modal.active { display: block; }
        .cart-sidebar { position: fixed; top: 0; right: -400px; width: 100%; max-width: 380px; height: 100%; background: white; z-index: 2000; transition: right 0.3s ease; display: flex; flex-direction: column; box-shadow: -5px 0 25px rgba(0,0,0,0.1); }
        .cart-sidebar.active { right: 0; }

        /* ===== FOOTER ===== */
        .main-footer { background: white; padding: 3rem 1rem 2rem; margin-top: 3rem; border-top: 1px solid #eee; text-align: center; }
        .social-links { display: flex; justify-content: center; gap: 1.5rem; margin: 1.5rem 0; }
        .social-link { color: var(--brand); font-size: 1.5rem; }
        .whatsapp-float { position: fixed; bottom: 2rem; right: 2rem; width: 60px; height: 60px; background: var(--wa); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; z-index: 999; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .notification { position: fixed; top: 20px; right: 20px; background: #2E8B57; color: white; padding: 1rem 1.5rem; border-radius: 6px; z-index: 3000; display: none; align-items: center; gap: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .notification.show { display: flex; }

        @media (max-width: 768px) {
            .hero-logo { width: 120px; height: 120px; }
            .hero-logo img { width: 80px; }
            .hero-title { font-size: 2.5rem; }
            .main-nav { gap: 1rem; justify-content: space-between; padding: 10px 20px; }
            .search-container { order: 2; width: 100%; margin-top: 10px; margin-right: 0; }
            .search-container input { width: 100%; }
            .products-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .product-modal-content { grid-template-columns: 1fr; padding: 1rem; }
            .story-container { grid-template-columns: 1fr; gap: 2rem; }
            .main-modal-img { height: 300px; }
        }
    </style>
</head>

<body>
    <div class="trust-banner">
        <span><i class="fas fa-certificate"></i> Devbhoomi Himachal</span>
        <span><i class="fas fa-hand-holding-heart"></i> 100% Handcrafted</span>
        <span><i class="fas fa-truck"></i> Pan India Shipping</span>
    </div>

    <a href="https://wa.me/919882212962" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <section class="hero-section" id="home">
        <div class="hero-logo-container">
            <div class="hero-logo">
                <img src="logo.png" alt="Handiweave Logo" onerror="this.style.display='none'">
            </div>
        </div>
        <h1 class="hero-title">HANDIWEAVE</h1>
        <p class="hero-tagline">Traditions and Trends</p>
        <p style="max-width: 700px; margin: 0 auto; opacity: 0.9;">
            Premium handcrafted wovens from Devbhoomi Himachal
        </p>
    </section>

    <div class="cart-icon" onclick="openCart()">
        <i class="fas fa-shopping-bag"></i>
        <span class="cart-count" id="cartCount">0</span>
    </div>

    <nav class="main-nav">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search product..." onkeyup="searchProducts(event)">
            <i class="fas fa-search" onclick="searchProducts(event)"></i>
        </div>
        <span class="nav-link active" onclick="switchView('home')">Home</span>
        <span class="nav-link" onclick="switchView('shop')">Wovens</span>
        <span class="nav-link" onclick="switchView('about')">Story</span>
        <span class="nav-link" onclick="switchView('blog')">Journal</span>
        <span class="nav-link" onclick="switchView('contact')">Contact</span>
        <span class="nav-link" onclick="switchView('policies')">Policies</span>
    </nav>

    <section id="shop-view" class="section-container active-section">
        <h2 style="text-align:center; margin-bottom:1rem;">Our Collection</h2>
        <div class="category-filters">
            <button class="filter-btn active" onclick="filterCategory('all', this)">All</button>
            <button class="filter-btn" onclick="filterCategory('Wovens', this)">Wovens</button>
            <button class="filter-btn" onclick="filterCategory('Cap', this)">Caps</button>
            <button class="filter-btn" onclick="filterCategory('Jacket', this)">Jackets</button>
            <button class="filter-btn" onclick="filterCategory('Home Decor', this)">Decor</button>
            <button class="filter-btn" onclick="filterCategory('Footwear', this)">Footwear</button>
        </div>
        <div class="products-grid" id="productsContainer"></div>
    </section>

    <section id="allseason-view" class="section-container craft-section">
        <h2 style="text-align:center; margin-bottom:1rem;">Beyond Seasons</h2>
        <p style="text-align:center; max-width:600px; margin:0 auto 2rem; color:#666;">
            Creating pieces that speak the language of comfort and style, season after season.
        </p>
        <div class="craft-grid">
            <div class="craft-card">
                <div class="craft-icon"><i class="fas fa-snowflake"></i></div>
                <h3>All Season Crafting</h3>
                <p>We are crafting pieces that feel like a warm hug in winter and a soft whisper in summer. Our all-season wovens adapt to you.</p>
            </div>
            <div class="craft-card">
                <div class="craft-icon"><i class="fas fa-yarn"></i></div>
                <h3>Knitting Stories</h3>
                <p>Every loop and stitch is a word in our storybook of textures. We knit not just fabrics, but narratives of home and heritage.</p>
            </div>
            <div class="craft-card">
                <div class="craft-icon"><i class="fas fa-ring"></i></div>
                <h3>Crochet Magic</h3>
                <p>Where a single thread transforms into intricate beauty. Our crochet pieces are spells woven with patience and love.</p>
            </div>
        </div>
    </section>

    <section id="about-view" class="section-container">
        <div class="story-container">
            <div class="story-image">
                <img src="cr1.jpg" alt="Handiweave Certificate" loading="lazy">
            </div>
            <div class="story-content">
                <h2>Our Story</h2>
                <div class="story-text">
                    <p><strong>Traditions and Trends.</strong> At Handiweave, we are more than just a marketplace; we are a platform empowering the skilled artisans of Himachal Pradesh. We provide a direct stage ('munch') for creators across the entire state‚Äînot just a single region‚Äîto showcase and market their authentic handmade crafts to the world.</p>
                    <p>By eliminating middlemen, we help artisans gain fair value for their work while preserving heritage. This is a collective effort to bring the hidden gems of Devbhoomi into the light. We are a firm registered under <strong>MSME, Govt. of India</strong>, committed to authentic growth.</p>
                    <img src="she1.jpg" style="width:100%; border-radius:8px; margin: 1.5rem 0;" alt="Artisan Work">
                    <p class="highlight-quote"><strong>"Supporting traditions, creating trends."</strong></p>
                </div>
            </div>
        </div>
        <div style="margin-top: 4rem;">
            <h3 style="text-align: center; margin-bottom: 1.5rem; color: var(--brand-dark);">Behind the Loom</h3>
            <div class="gallery-grid">
                <img src="ar1.jpg" alt="Artisan weaving" loading="lazy">
                <img src="ar2.jpg" alt="Handcrafting process" loading="lazy">
                <img src="ar3.jpg" alt="Detailed craftsmanship" loading="lazy">
                <img src="she1.jpg" alt="Wool source" loading="lazy">
            </div>
        </div>
    </section>

    <section id="blog-view" class="section-container" style="background-color: #fafafa; padding-top: 4rem;">
        <h2 style="text-align:center; margin-bottom:0.5rem; font-family:'Playfair Display', serif;">The Handiweave Journal</h2>
        <p style="text-align:center; color:#666; margin-bottom:3rem; font-style:italic;">Chronicles of the Loom, the Land, and the Legacy.</p>

        <div style="background:white; padding:2rem; border-radius:12px; box-shadow:0 5px 20px rgba(0,0,0,0.05); margin-bottom:3rem;">
            <div style="border-left:4px solid var(--gold); padding-left:20px; margin-bottom:1.5rem;">
                <h3 style="color:var(--brand-dark); margin-bottom:0.5rem; font-size:1.5rem;">Meet the Hands Behind the 'Handloom(khaddi)'</h3>
                <p style="color:#777; font-size:0.9rem;">Preserving the Soul of Himachal</p>
            </div>
            <div class="story-container" style="margin-top:0; align-items:flex-start;">
                <div class="story-image">
                    <img src="artisan1.jpg" alt="Bhanu Master Ji" loading="lazy" style="border-radius:8px; width:100%;">
                    <p style="text-align:center; font-size:0.85rem; color:#777; margin-top:5px;"><em>Master Weaver Bhanu Ji at work.</em></p>
                </div>
                <div class="story-content">
                    <p style="line-height:1.8; margin-bottom:1rem;">
                        At Handiweave, we don't have factories; we have <strong>Ghar-Aangan</strong> (homes). Our strength lies in the local artisans like <strong>Bhanu Master Ji</strong>, <strong>Shyamla Devi</strong>, and <strong>Raghuveer Ji</strong>.
                    </p>
                    <p style="line-height:1.8;">
                        These are the guardians of our <em>Virasat</em> (heritage). Their fingers move on the loom with a rhythm that no machine can replicate. We are simply a platform to bring their art from the valleys of Palampur to the world.
                    </p>
                </div>
            </div>
            <h4 style="text-align:center; margin: 2rem 0 1rem; color:var(--brand);">The 4-Day Ritual of Creation</h4>
            <div class="craft-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:15px; margin-top:0;">
                <div style="text-align:center;">
                    <img src="artisan.jpg" style="width:100%; height:160px; object-fit:cover; border-radius:8px;">
                    <h5 style="margin-top:8px; font-size:0.9rem;">1. Handloom</h5>
                </div>
                <div style="text-align:center;">
                    <img src="close.jpg" style="width:100%; height:160px; object-fit:cover; border-radius:8px;">
                    <h5 style="margin-top:8px; font-size:0.9rem;">2. Intricate Weaving</h5>
                </div>
                <div style="text-align:center;">
                    <img src="dori.jpg" style="width:100%; height:160px; object-fit:cover; border-radius:8px;">
                    <h5 style="margin-top:8px; font-size:0.9rem;">3. Hand-tied Dori</h5>
                </div>
            </div>
        </div>

        <div style="background:white; padding:2rem; border-radius:12px; box-shadow:0 5px 20px rgba(0,0,0,0.05);">
            <div style="border-left:4px solid #e74c3c; padding-left:20px; margin-bottom:1.5rem;">
                <h3 style="color:var(--brand-dark); margin-bottom:0.5rem; font-size:1.5rem;">Asli vs Nakli: The Truth About Himachali Topis</h3>
                <p style="color:#777; font-size:0.9rem;">How to identify authentic Handloom vs Machine Copies</p>
            </div>
            <p style="margin-bottom:2rem; line-height:1.8;">
                The market is flooded with cheap copies sold as "Himachali Topis". But true luxury lies in authenticity. Here is how you can spot the difference between an <em>Asli</em> (Real) Handloom piece and a machine-made fake.
            </p>
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:20px; margin-bottom:2rem;">
                <div style="background:#f4f4f4; padding:10px; border-radius:8px; text-align:center;">
                    <img src="weave.jpg" alt="Authentic Handloom" style="width:100%; height:200px; object-fit:cover; border-radius:6px; border:2px solid #27ae60;">
                    <h4 style="color:#27ae60; margin-top:10px;">ORIGINAL (Handloom) ‚úÖ</h4>
                    <p style="font-size:0.85rem; color:#555;">Design is woven into the fabric.</p>
                </div>
                <div style="background:#f4f4f4; padding:10px; border-radius:8px; text-align:center;">
                    <img src="emb.jpg" alt="Fake Machine Work" style="width:100%; height:200px; object-fit:cover; border-radius:6px; border:2px solid #e74c3c;">
                    <h4 style="color:#e74c3c; margin-top:10px;">FAKE (Embroidery) ‚ùå</h4>
                    <p style="font-size:0.85rem; color:#555;">Design is pasted/stitched on top.</p>
                </div>
            </div>
            <div style="background:#FFF8E1; padding:20px; border-radius:8px; border:1px solid #ffe0b2;">
                <h4 style="margin-bottom:1rem; color:#d35400;">üí° How to Identify? (3 Golden Rules)</h4>
                <ul style="padding-left:20px; line-height:1.8; color:#444;">
                    <li style="margin-bottom:10px;">
                        <strong>1. The 'Extra Weft' Technique:</strong> This is the biggest giveaway. In authentic handloom, the geometric design is created by inserting extra threads <em>during</em> the weaving process. 
                        <br>üëâ <strong>The Check:</strong> Look at the backside of the fabric. In real handloom, the design is visible on both sides (reverse colors). In fakes, the back is often covered with white fusing or looks messy.
                    </li>
                    <li style="margin-bottom:10px;">
                        <strong>2. Texture & Feel:</strong> Machine embroidery feels flat and plastic-like. Authentic wool has a natural, slightly coarse texture that breathes.
                    </li>
                    <li>
                        <strong>3. The Warmth:</strong> Real wool keeps you warm but doesn't make you sweat. Synthetic copies trap heat comfortably.
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <section id="contact-view" class="section-container">
        <h2>Contact Us</h2>
        <div class="contact-form">
            <form id="contactForm">
                <div class="form-group"><input type="text" name="name" class="form-control" placeholder="Your Name *" required></div>
                <div class="form-group"><input type="email" name="email" class="form-control" placeholder="Email Address *" required></div>
                <div class="form-group"><textarea name="message" class="form-control" placeholder="Your Message *" rows="5" required></textarea></div>
                <button type="submit" class="submit-btn"><i class="fas fa-paper-plane"></i> Send Message</button>
            </form>
            <div style="text-align:center; margin-top:2rem;">
                <p><i class="fas fa-phone-alt"></i> +91 98822 12962</p>
                <p><i class="fas fa-envelope"></i> handiweave@gmail.com</p>
            </div>
        </div>
    </section>

    <section id="policies-view" class="section-container">
        <h2>Our Policies</h2>
        <div class="policy-accordion">
            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(0)"><span><i class="fas fa-undo-alt"></i> Return & Refund Policy</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p><strong>Exchange Only Policy:</strong></p>
                    <ul style="margin-top:1rem; padding-left:1.2rem;">
                        <li>We do not offer refunds. Only exchanges are available within 7 days of delivery.</li>
                        <li>Products must be unused, unwashed, and with tags intact.</li>
                        <li>Items damaged by customer are not eligible for exchange.</li>
                        <li>To initiate an exchange, please contact us on WhatsApp.</li>
                    </ul>
                </div>
            </div>
            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(1)"><span><i class="fas fa-shipping-fast"></i> Shipping Policy</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p>We ship Pan-India via trusted courier partners. Delivery typically takes 5-7 business days depending on location.</p>
                </div>
            </div>
           <div class="policy-accordion">
            
            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(0)"><span><i class="fas fa-undo-alt"></i> Return & Refund Policy</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p><strong>Exchange Only Policy:</strong></p>
                    <ul style="margin-top:1rem; padding-left:1.2rem;">
                        <li>We do not offer refunds. Only exchanges are available within 7 days of delivery.</li>
                        <li>Products must be unused, unwashed, and with tags intact.</li>
                        <li>Items damaged by customer are not eligible for exchange.</li>
                        <li>To initiate an exchange, please contact us on WhatsApp.</li>
                    </ul>
                </div>
            </div>

            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(1)"><span><i class="fas fa-shipping-fast"></i> Shipping Policy</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p>We ship Pan-India via trusted courier partners.</p>
                    <ul style="margin-top:10px; padding-left:20px; line-height:1.6; color:#555;">
                        <li><strong>Small Orders (1-2 items):</strong> ‚Çπ40 Shipping</li>
                        <li><strong>Medium Orders (3-5 items):</strong> ‚Çπ120 Shipping</li>
                        <li><strong>Large Orders (6+ items):</strong> ‚Çπ150 Shipping</li>
                    </ul>
                    <p style="margin-top:10px; font-size:0.9rem;">Delivery typically takes 5-7 business days depending on location.</p>
                </div>
            </div>

            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(2)"><span><i class="fas fa-shield-alt"></i> Privacy Policy</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p>Your privacy is important to us. We never share your personal data. Secure payments via Razorpay.</p>
                </div>
            </div>

            <div class="policy-item">
                <div class="policy-header" onclick="togglePolicy(3)"><span><i class="fas fa-question-circle"></i> Need Help?</span><i class="fas fa-chevron-down"></i></div>
                <div class="policy-content">
                    <p>Have doubts about size, fabric, or shipping?</p>
                    <p style="margin-top:10px;">You can directly ask us on:</p>
                    <ul style="margin-top:5px; padding-left:20px; line-height:1.8;">
                        <li><i class="fab fa-whatsapp" style="color:#25D366;"></i> <strong>WhatsApp:</strong> +91 98822 12962</li>
                        <li><i class="fab fa-instagram" style="color:#C13584;"></i> <strong>Instagram:</strong> DM @handiweave</li>
                    </ul>
                </div>
            </div>

        </div>

    <footer class="main-footer">
        <div class="social-links">
            <a href="https://instagram.com/handiweave" class="social-link" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://wa.me/919882212962" class="social-link" target="_blank"><i class="fab fa-whatsapp"></i></a>
            <a href="https://x.com/handiweave" class="social-link" target="_blank"><i class="fab fa-twitter"></i></a>
        </div>
        <div class="footer-links">
            <span class="footer-link" onclick="switchView('shop')">Collection</span>
            <span class="footer-link" onclick="switchView('about')">Story</span>
            <span class="footer-link" onclick="switchView('policies')">Policies</span>
        </div>
        <div style="margin-top:1.5rem;">
            <p>handiweave@gmail.com | +91 98822 12962</p>
            <p style="margin-top:0.5rem; color:#666; font-size:0.9rem;">Devbhoomi Himachal</p>
        </div>
        <div style="margin-top:2rem;">
            <p>¬© 2025 Handiweave. All rights reserved.</p>
        </div>
    </footer>

    <div class="overlay" id="overlay"></div>

    <div class="product-modal" id="productModal">
        <div class="product-modal-content">
            <button class="modal-close-btn" onclick="closeProductModal()">&times;</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <aside class="cart-sidebar" id="cartSidebar">
        <div style="padding:1.5rem; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
            <h3>Your Bag</h3>
            <button class="modal-close" onclick="closeCart()" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
        </div>
        <div id="cartItemsList" style="flex:1; overflow-y:auto; padding:1.5rem;"></div>
        <div style="padding:1.5rem; border-top:1px solid #eee;">
            <div style="display:flex; justify-content:space-between; font-weight:700; margin-bottom:1.5rem;">
                <span>Total:</span><span id="cartTotalText">‚Çπ0</span>
            </div>
            <button onclick="openCheckout()" style="background:var(--brand); color:white; width:100%; padding:15px; border-radius:4px; font-weight:700; border:none; cursor:pointer;">Proceed to Checkout</button>
        </div>
    </aside>

    <div class="checkout-modal" id="checkoutModal">
        <button class="modal-close" onclick="closeCheckout()" style="position:absolute; top:15px; right:20px; background:none; border:none; font-size:1.5rem; cursor:pointer; color:#666;">&times;</button>
        <h2 style="margin-bottom:1.5rem;">Checkout</h2>
        <div id="checkoutSummary" style="margin-bottom:1.5rem; padding:1rem; background:#f9f9f9; border-radius:8px; font-size:0.9rem;"></div>
        <div style="font-size:1.3rem; font-weight:700; text-align:right; margin-bottom:1.5rem;">Total: <span id="checkoutTotal">‚Çπ0</span></div>
        <form id="checkoutForm">
            <div class="form-group"><input type="text" id="customerName" class="form-control" placeholder="Full Name *" required></div>
            <div class="form-group"><input type="tel" id="customerPhone" class="form-control" placeholder="Mobile Number *" required pattern="[0-9]{10}"></div>
            <div class="form-group"><input type="email" id="customerEmail" class="form-control" placeholder="Email Address (Optional)"></div>
            
            <h4 style="margin: 15px 0 10px; font-size: 0.95rem; color: var(--brand); border-bottom: 1px solid #eee; padding-bottom: 5px;">Shipping Address</h4>
            <div class="form-group"><input type="text" id="addrLine1" class="form-control" placeholder="House No, Village / Ward / Town *" required></div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <input type="text" id="addrDistrict" class="form-control" placeholder="District *" required>
                <input type="text" id="addrState" class="form-control" placeholder="State *" required value="Himachal Pradesh">
            </div>
            <div class="form-group" style="margin-top: 10px;"><input type="number" id="addrPin" class="form-control" placeholder="Pincode *" required></div>
            
            <div style="margin-top:15px; background:#fff8e1; padding:10px; border-radius:6px; border:1px dashed var(--gold);">
                <label style="display:flex; align-items:center; cursor:pointer; gap:10px; margin-bottom:0;">
                    <input type="checkbox" id="isGift" style="width:20px; height:20px; accent-color:var(--brand);">
                    <span style="font-size:0.9rem; color:var(--brand-dark);">
                        <strong>üéÅ Send as a Gift?</strong><br>
                        <span style="font-size:0.8rem; color:#666;">We'll remove the price tag & pack with love.</span>
                    </span>
                </label>
            </div>
            
            <div id="paymentButtons" style="margin-top:1.5rem;"></div>
        </form>
    </div>

    <div class="notification" id="notification"><i class="fas fa-check-circle"></i> <span id="notificationText"></span></div>

    <script>
        // Product data
        const PRODUCTS = [
            {
                "id": 1,
                "name": "Tripple (3) Patti Woolen Shawl",
                "category": "Wovens",
                "price": 2599,
                "originalPrice": 3499,
                "img": "3 patti kullu himachali handloom shawl1.1.jpg",
                "gallery": [
                    "3 patti kullu himachali handloom shawl1.1.jpg",
                    "3 patti kullu himachali handloom shawl1.2.jpg",
                    "3 patti kullu himachali handloom shawl1.3.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["Black", "White", "Grey(Shown)"]
                },
                "shortDesc": "Elegant tripple (3) patti design.",
                "desc": "Handwoven wool Shawl with a classic tripple patti design. Lightweight yet warm.Wrap yourself in the authentic warmth of the Kullu Valley. Meticulously hand-woven by local artisans, this shawl combines a solid, cozy base with vibrant, traditional patti (borders). It's designed to provide superior insulation during cold winters while keeping you elegant. A perfect gift of heritage that never goes out of fashion. Meticulously hand-woven by local artisans.",
                "care": "Hand or Machine wash below 40 degree, use mild detergent.",
                "inStock": true,
                "reviews": [
                    { "user": "Niharika Nerva", "rating": 5, "text": "Bhot sunder shawl hai.. design ekdm saaf hai or garam b hai. Packaging b achi thi. Thanks." },
                    { "user": "Anjali S.", "rating": 4, "text": "Authentic Kullu shawl. Pure wool feel hota hai." }
                ]
            },
            {
                "id": 2,
                "name": "Handloom made Signle Patti Woolen Shawl",
                "category": "Wovens",
                "price": 1599,
                "originalPrice": 2284,
                "img": "Single patti kullu himachali handloom Shawl1.1.jpg",
                "gallery": [
                    "Single patti kullu himachali handloom Shawl1.1.jpg",
                    "Single patti kullu himachali handloom Shawl1.2.jpg",
                    "Single patti kullu himachali handloom Shawl1.3.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["Light Grey(Shown)", "White", "Light Brown"]
                },
                "shortDesc": "Elegant single patti design.",
                "desc": "Handwoven wool Shawl with a classic single patti design. Lightweight yet warm.Wrap yourself in the authentic warmth of the Kullu Valley. Meticulously hand-woven by local artisans, this shawl combines a solid, cozy base with vibrant, traditional patti (borders). It's designed to provide superior insulation during cold winters while keeping you elegant. A perfect gift of heritage that never goes out of fashion.Handwoven wool Shawl with a classic single patti design. Lightweight yet warm. Perfect for everyday wear.",
                "care": "Hand or Machine wash below 40 degree.",
                "inStock": true,
                "reviews": [
                    { "user": "Nishant Choudhary", "rating": 5, "text": "Mene apni mummy k liye gift liya tha.. unko bhut pasand aaya. Keh ri thi chubhne wala material ni hai soft hai." },
                    { "user": "Rohan K.", "rating": 5, "text": "Best quality at this price." }
                ]
            },
          {
                "id": 3,
                "name": "Tripple (3) Patti Wool Stole",
                "category": "Wovens",
                "price": 949,
                "originalPrice": 1356,
                "img": "3 patti kullu himachali handloom Stole1.1.jpg",
                "gallery": [
                    "3 patti kullu himachali handloom Stole1.1.jpg",
                    "3 patti kullu himachali handloom Stole1.2.jpg",
                    "3 patti kullu himachali handloom Stole1.3.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["Grey (Shown)", "White", "Black", "Red"]
                },
                "shortDesc": "Elegant tripple (3) patti design.",
                "desc": "Handwoven wool Stole with a classic tripple patti design. Lightweight yet warm. This handloom stole is crafted for comfort, offering a soft texture and the vibrant, intricate patterns unique to the Kullu valley. A versatile accessory that adds an artistic touch to any outfit, whether you are dressing up for work or heading out for a casual evening.",
                "care": "Hand or Machine wash below 40 degree, use mild deteregent. Use Napthalene ball/ Camphor (Kapur) (when not in use).",
                "inStock": true
            },
            {
                "id": 4,
                "name": "Tripple (3) Patti Woolen Stole",
                "category": "Wovens",
                "price": 949,
                "originalPrice": 1356,
                "img": "3 patti kullu himachali handloom Stole2.1.jpg",
                "gallery": [
                    "3 patti kullu himachali handloom Stole2.1.jpg",
                    "3 patti kullu himachali handloom Stole2.2.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["Black (Shown)", "White", "Grey"]
                },
                "shortDesc": "Elegant tripple (3) patti design.",
                "desc": "Handwoven wool Stole with a classic tripple patti design. Lightweight yet warm. This handloom stole is crafted for comfort, offering a soft texture and the vibrant, intricate patterns unique to the Kullu valley. A versatile accessory that adds an artistic touch to any outfit, whether you are dressing up for work or heading out for a casual evening.",
                "care": "Hand or Machine wash below 40 degree, use mild deteregent. Use Napthalene ball/ Camphor (Kapur) (when not in use).",
                "inStock": true
            },
            {
                "id": 5,
                "name": "Trendy Woolen Stole single patti",
                "category": "Wovens",
                "price": 699,
                "originalPrice": 999,
                "img": "Single patti kullu himachali handloom Stole1.1.jpg",
                "gallery": [
                    "Single patti kullu himachali handloom Stole1.1.jpg",
                    "Single patti kullu himachali handloom Stole1.2.jpg",
                    "Single patti kullu himachali handloom Stole1.3.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["Black", "Red (Shown)", "White", "Grey", "Pink"]
                },
                "shortDesc": "Elegant Single patti design.",
                "desc": "Handwoven wool Stole with a classic patti design. Lightweight yet warm. This handloom stole is crafted for comfort, offering a soft texture and the vibrant, intricate patterns unique to the Kullu valley. A versatile accessory that adds an artistic touch to any outfit, whether you are dressing up for work or heading out for a casual evening",
                "care": "Hand or Machine wash below 40 degree.",
                "inStock": true
            },
            {
                "id": 6,
                "name": "Handmade handloom Coat Patti/yardages",
                "category": "Wovens",
                "price": 799,
                "originalPrice": 1141,
                "img": "handloom pure wool kulluvi coat patti yardage.jpg",
                "gallery": ["handloom pure wool kulluvi coat patti yardage.jpg"],
                "options": {
                    "type": "Color",
                    "values": ["Black (Shown)", "White", "Grey", "White with black stripes"]
                },
                "shortDesc": "Handmade Kulluvi yardage",
                "desc": "Handwoven yardage or kulluvi patti best suited for all weather due to its wicking nature and best suited for full nehru coat, half jackets, lowers and shirting.",
                "care": "Hand or Machine wash below 40 degree.",
                "inStock": true
            },
            {
                "id": 7,
                "name": "Himachali Traditional Cap Pahari topi",
                "category": "Cap",
                "price": 699,
                "originalPrice": 999,
                "img": "Traditional typical Kulluvi Himachali Cap pahari Topi.jpg",
                "gallery": [
                    "Traditional typical Kulluvi Himachali Cap pahari Topi.jpg",
                    "Traditional typical Kulluvi Himachali Cap pahari Topi1.jpg",
                    "cap size.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["Size 5 (Small)", "Size 6 (Medium)", "Size 7 (Large)"]
                },
                "shortDesc": "Authentic Himachal Topi",
                "desc": "Authentic colorful border cap from Himachal. Perfect for festive occasions.",
                "care": "Do not wash in machine.",
                "inStock": true
            },
            {
                "id": 8,
                "name": "Himachali Traditional Cap Pahari topi",
                "category": "Cap",
                "price": 599,
                "originalPrice": 856,
                "img": "Traditional Kulluvi Himachali Cap pahari Topi.jpg",
                "gallery": [
                    "Traditional Kulluvi Himachali Cap pahari Topi.jpg",
                    "Traditional Kulluvi Himachali Cap pahari Topi1.jpg",
                    "cap size.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["Size 5 (Small)", "Size 6 (Medium)", "Size 7 (Large)"]
                },
                "shortDesc": "Authentic Himachal Topi",
                "desc": "Authentic colorful border cap from Himachal. Perfect for festive occasions.",
                "care": "Do not wash in machine.",
                "inStock": true
            },
            {
                "id": 9,
                "name": "Maroon Himachali Cap Pahari topi",
                "category": "Cap",
                "price": 449,
                "originalPrice": 641,
                "img": "Maroon Himachali Cap pahari Topi.jpg",
                "gallery": [
                    "Maroon Himachali Cap pahari Topi.jpg",
                    "Maroon Himachali Cap pahari Topi1.jpg",
                    "cap size.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["Size 5 (Small)", "Size 6 (Medium)", "Size 7 (Large)"]
                },
                "shortDesc": "Authentic Himachal Topi",
                "desc": "Authentic cap from Himachal in Maroon base.",
                "care": "Do not wash in machine.",
                "inStock": true
            },
            {
                "id": 10,
                "name": "Green Himachali Cap Pahari topi",
                "category": "Cap",
                "price": 449,
                "originalPrice": 641,
                "img": "Green Himachali Cap Pahari Topi.jpg",
                "gallery": [
                    "Green Himachali Cap Pahari Topi1.jpg",
                    "cap size.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["Size 5 (Small)", "Size 6 (Medium)", "Size 7 (Large)"]
                },
                "shortDesc": "Authentic Himachal Topi",
                "desc": "Authentic cap from Himachal in Green base.",
                "care": "Do not wash in machine.",
                "inStock": true
            },
            {
                "id": 11,
                "name": "Kingri Malana Himachali Cap",
                "category": "Cap",
                "price": 549,
                "originalPrice": 784,
                "img": "Kingri Malana Himachali Cap Pahari Topi.jpg",
                "gallery": [
                    "Kingri Malana Himachali Cap Pahari Topi.jpg",
                    "Kingri Malana Himachali Cap Pahari Topi1.jpg",
                    "cap size.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["Size 5 (Small)", "Size 6 (Medium)", "Size 7 (Large)"]
                },
                "shortDesc": "Authentic Malana Style Topi",
                "desc": "Authentic Kingri Malana cap from Himachal.",
                "care": "Do not wash in machine.",
                "inStock": true
            },
            {
                "id": 12,
                "name": "Unisex Wool Hoodie (Blue/Gold)",
                "category": "Wovens",
                "price": 1099,
                "originalPrice": 1570,
                "img": "unisex blue hoodie golden broad border 1.1.jpg",
                "gallery": [
                    "unisex blue hoodie golden broad border 1.1.jpg",
                    "unisex blue hoodie golden broad border 1.2.jpg",
                    "unisex hoodie fleece.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["S", "M", "L", "XL", "XXL"]
                },
                "shortDesc": "Handwoven winter hoodie.",
                "desc": "A warm, breathable woolen hoodie suitable for both men and women.",
                "care": "Hand wash with cold water.",
                "inStock": true
            },
            {
                "id": 13,
                "name": "Unisex Wool Hoodie (Golden Broad)",
                "category": "Wovens",
                "price": 1099,
                "originalPrice": 1570,
                "img": "unisex hoodie golden broad border 1.1.jpg",
                "gallery": [
                    "unisex hoodie golden broad border 1.1.jpg",
                    "unisex hoodie fleece.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["S", "M", "L", "XL", "XXL"]
                },
                "shortDesc": "Handwoven winter hoodie.",
                "desc": "A warm, breathable woolen hoodie.",
                "care": "Hand wash with cold water.",
                "inStock": true
            },
            {
                "id": 14,
                "name": "Unisex Wool Hoodie (3Golden Broad)",
                "category": "Wovens",
                "price": 1199,
                "originalPrice": 1713,
                "img": "unisex hoodie 3golden broad border 1.1.jpg",
                "gallery": [
                    "unisex hoodie 3golden broad border 1.1.jpg",
                    "unisex hoodie fleece.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["S", "M", "L", "XL", "XXL"]
                },
                "shortDesc": "Handwoven winter hoodie.",
                "desc": "A warm, breathable woolen hoodie suitable for both men and women.",
                "care": "Hand wash with cold water.",
                "inStock": true
            },
            {
                "id": 15,
                "name": "Unisex Wool Hoodie (Grey)",
                "category": "Wovens",
                "price": 999,
                "originalPrice": 1427,
                "img": "unisex grey hoodie narrow border border 1.1.jpg",
                "gallery": [
                    "unisex grey hoodie narrow border border 1.1.jpg",
                    "unisex grey hoodie narrow border border 1.2.jpg",
                    "unisex grey hoodie narrow border border 1.3.jpg",
                    "unisex hoodie fleece.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["S", "M", "L", "XL", "XXL"]
                },
                "shortDesc": "Handwoven winter hoodie.",
                "desc": "A warm, breathable woolen hoodie suitable for both men and women.",
                "care": "Hand wash with cold water.",
                "inStock": true
            },
            {
                "id": 16,
                "name": "Royal Angora Shawl",
                "category": "Wovens",
                "price": 5499,
                "originalPrice": 7856,
                "img": "royal-angora-white.jpg",
                "gallery": ["royal-angora-white.jpg"],
                "options": null,
                "shortDesc": "Premium Angora Wool.",
                "desc": "Luxurious and extremely soft Angora wool shawl. Very warm and lightweight.",
                "care": "Expert Dry Clean Only.",
                "inStock": true
            },
            {
                "id": 17,
                "name": "Pure wool Half Jacket (Nehru Jacket)",
                "category": "Jacket",
                "price": 1099,
                "originalPrice": 1570,
                "img": "Pure Wool Men's Half jacket sadri.jpg",
                "gallery": [
                    "Pure Wool Men's Half jacket sadri.jpg",
                    "Pure Wool Men's Half jacket sadri1.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["38", "40", "42", "44"]
                },
                "shortDesc": "Stylish woolen jacket.",
                "desc": "Traditional weave jacket with modern fitting. Can be worn over kurta or shirt.",
                "care": "Dry Clean Only.",
                "inStock": true,
                "reviews": [
                    { "user": "Sarita Devi", "rating": 5, "text": "Mere husband k liye mangvaya tha size 40.. fitting ekdm perfect aayi hai. Wool pure lg ra hai. Acha product hai." },
                    { "user": "Vikram", "rating": 4, "text": "Nice jacket, looks royal with kurta." }
                ]
            },
            {
                "id": 18,
                "name": "Unisex Muffler",
                "category": "Wovens",
                "price": 399,
                "originalPrice": 570,
                "img": "Unisex Muffler kulluvi border pure wool.jpg",
                "gallery": [
                    "Unisex Muffler kulluvi border pure wool.jpg",
                    "Unisex Muffler kulluvi border pure wool1.jpg"
                ],
                "options": {
                    "type": "Color",
                    "values": ["White", "Grey", "Light Brown", "Black"]
                },
                "shortDesc": "Traditional lightweight Muffler",
                "desc": "Traditional weave muffler with kulluvi motifs. Pure wool.",
                "care": "Hand wash/Dry Clean.",
                "inStock": true,
                "reviews": [
                    { "user": "Rajesh Kumar", "rating": 5, "text": "Sister k liye liya tha college jane ko.. bhot bdia quality hai bhai. Price b theek hai." },
                    { "user": "Dev", "rating": 5, "text": "Warm and stylish." }
                ]
            },
            {
                "id": 19,
                "name": "Handmade Unisex Stripe Muffler",
                "category": "Wovens",
                "price": 399,
                "originalPrice": 570,
                "img": "stripe1.jpg",
                "gallery": [
                    "stripe1.jpg",
                    "stripe2.jpg"
                ],
                "options": null,
                "shortDesc": "Traditional weave muffler",
                "desc": "Traditional weave muffler with kulluvi motifs. Purewool muffler weave on traditional handloom.",
                "care": "Hand wash/Dry Clean.",
                "inStock": true
            },
            {
                "id": 20,
                "name": "Embroided Women's Sleeveless Jacket (Black)",
                "category": "Jacket",
                "price": 799,
                "originalPrice": 1199,
                "img": "Embroided Sleeveless women's black jackets.jpg",
                "gallery": [
                    "Embroided Sleeveless women's black jackets.jpg",
                    "Embroided Sleeveless women's black jackets1.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["38", "40", "42", "44"]
                },
                "shortDesc": "Stylish sleeveless woolen jacket.",
                "desc": "Women's sleeveless jacket inspired by traditional winter clothing.The sleeveless pattern makes it easy to wear over kurtis, sweaters, or dresses. The jacket is comfortable, lightweight, and suitable for regular use during cold weather. The embroidery is neatly done and adds a subtle ethnic touch without making the jacket heavy.",
                "care": "Hand wash, Dry Clean.",
                "inStock": true
            },
            {
                "id": 21,
                "name": "Embroided Women's Sleeveless Jacket",
                "category": "Jacket",
                "price": 799,
                "originalPrice": 1199,
                "img": "Embroided Sleeveless women's jackets.jpg",
                "gallery": [
                    "Embroided Sleeveless women's jackets.jpg",
                    "Embroided Sleeveless women's jackets1.jpg"
                ],
                "options": {
                    "type": "Size",
                    "values": ["38", "40", "42", "44"]
                },
                "shortDesc": "Stylish woolen jacket.",
                "desc": "Women's sleeveless jacket inspired by traditional winter clothing.The sleeveless pattern makes it easy to wear over kurtis, sweaters, or dresses. The jacket is comfortable, lightweight, and suitable for regular use during cold weather. The embroidery is neatly done and adds a subtle ethnic touch without making the jacket heavy.",
                "care": "Hand wash, Dry Clean.",
                "inStock": true
            },
            {
                "id": 22,
                "name": "Extra weft Work Wall Decor",
                "category": "Home Decor",
                "price": 1499,
                "originalPrice": 2141,
                "img": "2.wall.jpg",
                "gallery": ["2.wall.jpg"],
                "options": {
                    "type": "Size",
                    "values": ["15*18 in"]
                },
                "shortDesc": "Heritage Wall Art",
                "desc": "15x18 inches (Per Panel) Made of pure wool material, wooden frame, Glass Panel",
                "care": "Dust with Soft Cloth.",
                "inStock": true
            },
            {
                "id": 23,
                "name": "Extra weft Work Wall Decor",
                "category": "Home Decor",
                "price": 2099,
                "originalPrice": 2999,
                "img": "3.wall.jpg",
                "gallery": ["3.wall.jpg"],
                "options": {
                    "type": "Size",
                    "values": ["15*18 in"]
                },
                "shortDesc": "Heritage Wall Art",
                "desc": "15x18 inches (Per Panel) Made of pure wool material, wooden frame, Glass Panel",
                "care": "Dust with Soft Cloth.",
                "inStock": false,
                "reviews": [
                    { "user": "Mayank Sharma", "rating": 5, "text": "Masterpiece! Love from Bangalore." }
                ]
            },
            {
                "id": 24,
                "name": "Himachali pahadi Pulla/slippers",
                "category": "Footwear",
                "price": 349,
                "originalPrice": 570,
                "img": "Himachali Pullan hemp.jpg",
                "gallery": [
                    "Himachali Pullan hemp.jpg",
                    "Himachali Pullan hemp1.jpg"
                ],
                "options": null,
                "shortDesc": "Traditional handcrafted footwear",
                "desc": "Free Size Pahadi pulla or handmade slippers are woven with hemp bark by handicraft artisans, using colorful threads for decoration. Traditionally used for temple/kitchen, made of fully natural fibre.",
                "care": "keep them dry,avoid water.",
                "inStock": true,
                "reviews": [
                    { "user": "Amit", "rating": 4, "text": "Ghar mein pehnne k liye best hai. look b traditional hai." },
                    { "user": "Devansh Thakur", "rating": 5, "text": "Old memories refreshed. Good work." }
                ]
            }
        ];

        let cart = JSON.parse(localStorage.getItem('handiweave_cart')) || [];
        const RAZORPAY_KEY = "rzp_live_RuhteYn3JzTrhD";

        // ===== UTILITY FUNCTIONS =====
        function formatPrice(p) { return '‚Çπ' + p.toLocaleString('en-IN'); }
        
        function showNotification(msg) {
            const n = document.getElementById('notification');
            document.getElementById('notificationText').textContent = msg;
            n.classList.add('show'); 
            setTimeout(() => n.classList.remove('show'), 3000);
        }
        
        function saveCart() { 
            localStorage.setItem('handiweave_cart', JSON.stringify(cart)); 
            updateCartCount(); 
        }
        
        function updateCartCount() { 
            const count = cart.reduce((t,i) => t + i.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }
        
        function getCartTotal() { 
            return cart.reduce((t,i) => t + (i.price * i.quantity), 0); 
        }

        // ===== NEW: CALCULATE SHIPPING BASED ON QUANTITY =====
        function calculateShipping() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            if (totalItems <= 2) return 40;
            else if (totalItems <= 5) return 120;
            else return 150;
        }

      // ===== RENDER PRODUCTS (Final & Perfect) =====
        function renderProducts(items = PRODUCTS) {
            const container = document.getElementById('productsContainer');
            if(items.length === 0) {
                container.innerHTML = '<p style="grid-column:1/-1;text-align:center;">No products found.</p>';
                return;
            }
            container.innerHTML = items.map(p => {
                const discount = Math.round(((p.originalPrice - p.price) / p.originalPrice) * 100);
                
                return `
                <div class="product-card">
                    <span class="discount-badge">${discount}% OFF</span>
                    ${!p.inStock ? '<span class="sold-out-badge">SOLD OUT</span>' : ''}
                    
                    <div class="product-image" onclick="openProductModal(${p.id})">
                        <img src="${p.img}" alt="${p.name}" loading="lazy" onerror="this.src='https://placehold.co/300x300?text=Handiweave';">
                        ${!p.inStock ? '<div style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,0.6);"></div>' : ''}
                    </div>

                    <div class="product-info">
                        <div class="product-name" style="cursor:pointer;" onclick="openProductModal(${p.id})">${p.name}</div>
                        
                        <div class="product-price">
                            <span class="original-price">${formatPrice(p.originalPrice)}</span>
                            ${formatPrice(p.price)} <span style="font-size:0.7em;font-weight:400;color:#555;">(Inc. GST)</span>
                        </div>

                        <button class="add-to-cart-btn" onclick="openProductModal(${p.id})" ${!p.inStock ? 'disabled style="background:#888;"' : ''}>
                            <i class="fas fa-shopping-bag"></i> ${p.inStock ? ' ADD TO BAG' : ' Sold Out'}
                        </button>
                        
                        <div style="margin-top:8px; font-size:0.85rem; text-decoration:underline; color:#666; cursor:pointer; padding: 5px;" onclick="openProductModal(${p.id})">
                            View More Details
                        </div>
                    </div>
                </div>
            `}).join('');
        }

       // ===== PRODUCT MODAL (Final Logic: GST, Reviews, Gallery, Options) =====
        function openProductModal(id) {
            // 1. Find Product
            const product = PRODUCTS.find(p => p.id === id);
            if(!product) return;
            
            const modal = document.getElementById('productModal');
            const body = document.getElementById('modalBody');

            // 2. Build Options (Size/Color)
            let optionsHTML = '';
            if(product.options) {
                const opts = product.options.values.map(v => `<option value="${v}">${v}</option>`).join('');
                optionsHTML = `
                    <div class="variant-selector">
                        <label>Select ${product.options.type}:</label>
                        <select id="modalVariantSelect">${opts}</select>
                    </div>
                `;
            }

            // 3. Build Gallery Thumbs
            let thumbs = product.gallery.map(src => 
                `<img src="${src}" class="thumb-img" loading="lazy" onclick="document.querySelector('.main-modal-img').src='${src}'">`
            ).join('');

            // 4. Build Reviews
            let reviewsHTML = '';
            if (product.reviews && product.reviews.length > 0) {
                const reviewsList = product.reviews.map(r => `
                    <div class="review-card">
                        <div class="review-header">
                            <span>${r.user}</span>
                            <span class="stars">${'‚òÖ'.repeat(r.rating)}</span>
                        </div>
                        <div style="color:#555;">"${r.text}"</div>
                    </div>
                `).join('');
                
                reviewsHTML = `
                    <div class="review-section">
                        <div class="review-title">Customer Reviews (${product.reviews.length})</div>
                        ${reviewsList}
                    </div>
                `;
            } else {
                reviewsHTML = `<div class="review-section" style="color:#777; font-style:italic;">No reviews yet. Be the first to buy!</div>`;
            }

            // 5. Inject Everything into Modal HTML
            body.innerHTML = `
                <div class="modal-gallery">
                    <img src="${product.img}" alt="${product.name}" class="main-modal-img" loading="lazy" onerror="this.src='https://placehold.co/400x400?text=Handiweave';">
                    <div class="thumb-grid">${thumbs}</div>
                </div>
                
                <div class="modal-details">
                    <h2>${product.name}</h2>
                    
                    <div class="modal-price">
                        <span style="color:#999; text-decoration:line-through; font-size:1rem; font-weight:normal;">${formatPrice(product.originalPrice)}</span>
                        ${formatPrice(product.price)} <span style="font-size:0.6em;font-weight:400;color:#555;">(Inc. GST)</span>
                    </div>

                    <div class="modal-short-desc">${product.shortDesc}</div>
                    <div class="modal-desc">${product.desc}</div>
                    
                    ${product.inStock ? optionsHTML : ''}
                    
                    <div class="action-buttons">
                        <button class="add-to-cart-btn" style="flex:2; padding:15px; ${!product.inStock ? 'background:#888;cursor:not-allowed;' : ''}" 
                            onclick="addToCartFromModal(${product.id})" ${!product.inStock ? 'disabled' : ''}>
                            ${product.inStock ? 'ADD TO BAG' : 'OUT OF STOCK'}
                        </button>
                        <button class="share-btn" onclick="shareProduct(${product.id})">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>

                    <div class="modal-care"><strong>Care:</strong> ${product.care}</div>
                    
                    ${reviewsHTML}
                </div>
            `;

            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // ===== CLOSE MODAL FUNCTION (Zaroori hai) =====
        function closeProductModal() { 
            document.getElementById('productModal').style.display = 'none'; 
            document.body.style.overflow = 'auto';
        }
        // ===== SHARE PRODUCT (FIXED) =====
        function shareProduct(productId) {
            const product = PRODUCTS.find(p => p.id === productId);
            if(!product) return;
            
            // Create a clean URL without existing parameters
            const baseUrl = window.location.origin + window.location.pathname;
            const shareUrl = `${baseUrl}?product=${productId}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Handiweave - ' + product.name,
                    text: `Check out ${product.name} on Handiweave!`,
                    url: shareUrl
                }).catch(console.error);
            } else {
                const text = `Check out ${product.name} on Handiweave! ${shareUrl}`;
                window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`, '_blank');
            }
        }

        // ===== ADD TO CART FROM MODAL =====
        function addToCartFromModal(id) {
            const product = PRODUCTS.find(p => p.id === id);
            if (!product.inStock) return; 

            let selectedVariant = 'Standard';
            
            const selectBox = document.getElementById('modalVariantSelect');
            if (selectBox) selectedVariant = selectBox.value;

            // Check if item exists with same variant
            const existingItem = cart.find(i => i.id === id && i.variant === selectedVariant);

            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    img: product.img,
                    variant: selectedVariant,
                    quantity: 1
                });
            }

            saveCart();
            closeProductModal();
            showNotification('Added to Bag');
            openCart(); 
        }

        // ===== CART FUNCTIONS =====
        function openCart() {
            renderCartItems();
            document.getElementById('cartSidebar').classList.add('active');
            document.getElementById('overlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeCart() {
            document.getElementById('cartSidebar').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function renderCartItems() {
            const container = document.getElementById('cartItemsList');
            if (!cart.length) {
                container.innerHTML = '<p style="text-align:center;color:#666;">Bag is empty</p>';
                document.getElementById('cartTotalText').textContent = '‚Çπ0';
                return;
            }
            container.innerHTML = cart.map((item, idx) => `
                <div style="display:flex; justify-content:space-between; margin-bottom:1rem; border-bottom:1px solid #f0f0f0; padding-bottom:10px;">
                    <div style="display:flex; gap:10px;">
                        <img src="${item.img}" style="width:50px; height:50px; object-fit:cover; border-radius:4px;" loading="lazy" onerror="this.src='https://placehold.co/100x100?text=HW';">
                        <div>
                            <div style="font-weight:600; font-size:0.9rem;">${item.name}</div>
                            <div style="font-size:0.8rem; color:#666;">${item.variant}</div>
                            <div style="font-size:0.8rem;">${formatPrice(item.price)} x ${item.quantity}</div>
                        </div>
                    </div>
                    <div style="display:flex; align-items:center; gap:5px;">
                        <button onclick="updateQty(${idx}, -1)" style="width:25px;height:25px;border:none;background:#eee;">-</button>
                        <span style="font-size:0.9rem;">${item.quantity}</span>
                        <button onclick="updateQty(${idx}, 1)" style="width:25px;height:25px;border:none;background:#eee;">+</button>
                        <i class="fas fa-trash" style="color:#d9534f; margin-left:8px; cursor:pointer;" onclick="removeCartItem(${idx})"></i>
                    </div>
                </div>
            `).join('');
            document.getElementById('cartTotalText').textContent = formatPrice(getCartTotal());
        }

        function updateQty(idx, change) {
            cart[idx].quantity += change;
            if (cart[idx].quantity < 1) cart.splice(idx, 1);
            saveCart(); 
            renderCartItems();
        }
        
        function removeCartItem(idx) { 
            cart.splice(idx, 1); 
            saveCart(); 
            renderCartItems(); 
        }

    // ===== CHECKOUT FUNCTIONS (Step 1: Open Checkout Logic) =====
        function openCheckout() {
            // 1. Check if cart is empty
            if(cart.length === 0) {
                showNotification('Your cart is empty!');
                return;
            }

            // 2. Close the cart sidebar first
            closeCart();
            
            // 3. Calculate Totals (Using Quantity-Based Shipping)
            const subtotal = getCartTotal();
            const shipping = calculateShipping(); // Uses the 40/120/150 logic
            const finalTotal = subtotal + shipping;

            // 4. Build Order Summary HTML
            let summaryHTML = '<h4>Order Summary</h4>';
            cart.forEach(item => {
                summaryHTML += `<div style="display:flex; justify-content:space-between; margin:5px 0;">
                    <span>${item.name} x${item.quantity}</span>
                    <span>${formatPrice(item.price * item.quantity)}</span>
                </div>`;
            });
            
            // Get total count for display
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            summaryHTML += `<hr style="margin:10px 0;">
                <div style="display:flex; justify-content:space-between;">
                    <span>Subtotal:</span>
                    <span>${formatPrice(subtotal)}</span>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <span>Shipping (${totalItems} items):</span>
                    <span>${formatPrice(shipping)}</span>
                </div>`;

            // 5. Inject Summary and Grand Total
            document.getElementById('checkoutSummary').innerHTML = summaryHTML;
            document.getElementById('checkoutTotal').textContent = formatPrice(finalTotal);

            // 6. Add Payment Buttons (Razorpay, GPay, UPI, WhatsApp)
            document.getElementById('paymentButtons').innerHTML = `
                <button type="button" onclick="checkoutWithRazorpay()" style="background:var(--rzp); color:white; width:100%; padding:15px; border-radius:4px; margin-bottom:10px; border:none; font-weight:bold; cursor:pointer;">
                    <i class="fas fa-credit-card"></i> Pay with Razorpay (${formatPrice(finalTotal)})
                </button>
                
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px;">
                    <button type="button" onclick="initiateUPIPayment('9882212962@upi')" style="background:#34a853; color:white; padding:12px; border-radius:4px; border:none; font-weight:bold; cursor:pointer;">
                        <i class="fab fa-google-pay"></i> Google Pay
                    </button>
                    <button type="button" onclick="initiateUPIPayment('sahik886@okaxis')" style="background:#0080FF; color:white; padding:12px; border-radius:4px; border:none; font-weight:bold; cursor:pointer;">
                        <i class="fas fa-university"></i> UPI Apps
                    </button>
                </div>
                
                <button type="button" onclick="checkoutWithWhatsApp()" style="background:var(--wa); color:white; width:100%; padding:15px; border-radius:4px; border:none; font-weight:bold; cursor:pointer;">
                    <i class="fab fa-whatsapp"></i> Order via WhatsApp
                </button>
            `;

            // 7. Show the Modal
            document.getElementById('checkoutModal').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        // ===== VALIDATE CHECKOUT FORM =====
        function validateCheckoutForm() {
            const requiredFields = [
                {id: 'customerName', name: 'Full Name'},
                {id: 'customerPhone', name: 'Mobile Number'},
                {id: 'addrLine1', name: 'Address'},
                {id: 'addrDistrict', name: 'District'},
                {id: 'addrState', name: 'State'},
                {id: 'addrPin', name: 'Pincode'}
            ];
            
            for (let field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element || !element.value.trim()) {
                    showNotification(`Please fill in ${field.name}`);
                    element?.focus();
                    return false;
                }
            }
            
            const phone = document.getElementById('customerPhone').value;
            if (!/^[0-9]{10}$/.test(phone)) {
                showNotification('Please enter a valid 10-digit mobile number');
                return false;
            }
            
            return true;
        }

        // ===== VALIDATE CHECKOUT FORM =====
        function validateCheckoutForm() {
            const requiredFields = [
                {id: 'customerName', name: 'Full Name'},
                {id: 'customerPhone', name: 'Mobile Number'},
                {id: 'addrLine1', name: 'Address'},
                {id: 'addrDistrict', name: 'District'},
                {id: 'addrState', name: 'State'},
                {id: 'addrPin', name: 'Pincode'}
            ];
            
            for (let field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element || !element.value.trim()) {
                    showNotification(`Please fill in ${field.name}`);
                    element?.focus();
                    return false;
                }
            }
            
            const phone = document.getElementById('customerPhone').value;
            if (!/^[0-9]{10}$/.test(phone)) {
                showNotification('Please enter a valid 10-digit mobile number');
                return false;
            }
            
            return true;
        }

        // ===== PAYMENT FUNCTIONS (Corrected Address & Shipping Logic) =====
        function checkoutWithRazorpay() {
            if (!validateCheckoutForm()) return;
            
            // 1. Get Customer Details
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const email = document.getElementById('customerEmail').value;
            
            // 2. Get Address & Gift Info (CRITICAL FIX)
            const addrLine1 = document.getElementById('addrLine1').value;
            const addrDistrict = document.getElementById('addrDistrict').value;
            const addrState = document.getElementById('addrState').value;
            const addrPin = document.getElementById('addrPin').value;
            const isGift = document.getElementById('isGift').checked ? 'Yes' : 'No';
            
            // Combine Address for Formspree
            const fullAddress = `${addrLine1}, ${addrDistrict}, ${addrState} - ${addrPin} (Gift: ${isGift})`;

            // 3. Calculate Totals (Using Quantity-Based Shipping)
            const subtotal = getCartTotal();
            const shipping = calculateShipping();
            const finalTotal = subtotal + shipping;
            
            const options = {
                key: RAZORPAY_KEY,
                amount: finalTotal * 100, // Amount in paise
                currency: 'INR',
                name: 'Handiweave',
                description: 'Handicraft Purchase',
                handler: function(response) {
                    showNotification('Payment successful! Order placed.');
                    
                    // 4. Send Data to Formspree (With Full Address)
                    const formData = new FormData();
                    formData.append('Order Summary', `ID: ${response.razorpay_payment_id} | Total: ‚Çπ${finalTotal} (Ship: ‚Çπ${shipping})`);
                    formData.append('Cart Items', JSON.stringify(cart));
                    formData.append('Customer Details', `Name: ${name}\nPhone: ${phone}\nEmail: ${email}\nAddress: ${fullAddress}`);
                    
                    fetch("https://formspree.io/f/xlgdnggr", { method: "POST", body: formData, headers: {'Accept': 'application/json'} });

                    // Clear Cart
                    cart = [];
                    saveCart();
                    updateCartCount();
                    closeCheckout();
                },
                prefill: {
                    name: name,
                    email: email || 'customer@handiweave.com',
                    contact: phone
                },
                theme: {
                    color: '#7A5548'
                },
                modal: {
                    ondismiss: function() {
                        showNotification('Payment cancelled');
                    }
                }
            };
            
            try {
                const rzp = new Razorpay(options);
                rzp.open();
            } catch (error) {
                showNotification('Payment gateway error. Please try UPI or WhatsApp.');
            }
        }

        function initiateUPIPayment(upiId) {
            if (!validateCheckoutForm()) return;
            
            const subtotal = getCartTotal();
            const shipping = calculateShipping();
            const finalTotal = subtotal + shipping;
            
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            
            // Generate UPI Deep Link
            const upiLink = `upi://pay?pa=${upiId}&pn=Handiweave&am=${finalTotal}&cu=INR&tn=Order%20${Date.now()}&mc=5411`;
            
            // Try to open UPI app
            window.location.href = upiLink;
            
            // Fallback instructions
            setTimeout(() => {
                showNotification(`Pay ‚Çπ${finalTotal} to ${upiId}. Send payment screenshot on WhatsApp.`);
                
                // Save order details locally for WhatsApp follow-up
                const orderDetails = {
                    name: name,
                    phone: phone,
                    items: cart.map(item => `${item.name} x${item.quantity}`).join(', '),
                    total: finalTotal,
                    upiId: upiId,
                    timestamp: Date.now()
                };
                localStorage.setItem('pending_upi_order', JSON.stringify(orderDetails));
            }, 1000);
        }

        function checkoutWithWhatsApp() {
            if (!validateCheckoutForm()) return;
            
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const email = document.getElementById('customerEmail').value;
            const addrLine1 = document.getElementById('addrLine1').value;
            const addrDistrict = document.getElementById('addrDistrict').value;
            const addrState = document.getElementById('addrState').value;
            const addrPin = document.getElementById('addrPin').value;
            const isGift = document.getElementById('isGift').checked ? 'Yes' : 'No';
            
            const subtotal = getCartTotal();
            const shipping = calculateShipping();
            const finalTotal = subtotal + shipping;
            
            let itemsText = '';
            cart.forEach(item => {
                itemsText += `‚Ä¢ ${item.name} (${item.variant}) x${item.quantity}: ‚Çπ${item.price * item.quantity}\n`;
            });
            
            const addressText = `Address: ${addrLine1}, ${addrDistrict}, ${addrState} - ${addrPin}\n`;
            
            const message = `*NEW ORDER REQUEST*\n\n*Customer Details:*\nName: ${name}\nPhone: ${phone}\nEmail: ${email || 'Not provided'}\n${addressText}Gift Wrap: ${isGift}\n\n*Order Items:*\n${itemsText}\n*Order Summary:*\nSubtotal: ‚Çπ${subtotal}\nShipping: ‚Çπ${shipping}\n*Total: ‚Çπ${finalTotal}*\n\nPayment Method: Cash on Delivery / UPI`;
            
            window.open(`https://wa.me/919882212962?text=${encodeURIComponent(message)}`, '_blank');
        }

        // ===== SEARCH FUNCTION =====
        function searchProducts(event) {
            if (event && event.type === 'keyup' && event.key !== 'Enter') return;
            
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            // Switch to shop view
            switchView('shop');
            
            setTimeout(() => {
                if (!searchTerm) {
                    renderProducts(PRODUCTS);
                    return;
                }
                
                const filtered = PRODUCTS.filter(p => 
                    p.name.toLowerCase().includes(searchTerm) || 
                    p.category.toLowerCase().includes(searchTerm) ||
                    (p.desc && p.desc.toLowerCase().includes(searchTerm)) ||
                    (p.shortDesc && p.shortDesc.toLowerCase().includes(searchTerm))
                );
                
                renderProducts(filtered);
                
                // Update filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.filter-btn').classList.add('active');
            }, 100);
        }

        // ===== NAVIGATION (FIXED HERO HIDING) =====
        function switchView(view) {
            // Hide all sections
            document.querySelectorAll('.section-container').forEach(section => {
                section.classList.remove('active-section');
            });
            
            // Show/hide hero section
            if (view === 'home') {
                document.body.classList.remove('hide-hero');
                // Show shop section for home
                document.getElementById('shop-view').classList.add('active-section');
            } else {
                document.body.classList.add('hide-hero');
                // Show the selected section
                const section = document.getElementById(view + '-view');
                if (section) {
                    section.classList.add('active-section');
                }
            }
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if ((link.textContent === 'Home' && view === 'home') ||
                    (link.textContent === 'Wovens' && view === 'shop') ||
                    (link.textContent === 'Story' && view === 'about') ||
                    (link.textContent === 'Journal' && view === 'blog') ||
                    (link.textContent === 'Contact' && view === 'contact') ||
                    (link.textContent === 'Policies' && view === 'policies')) {
                    link.classList.add('active');
                }
            });
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // If home or shop view, render products
            if (view === 'shop' || view === 'home') {
                renderProducts(PRODUCTS);
            }
        }

        // ===== CATEGORY FILTER =====
        function filterCategory(cat, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            if(cat === 'all') {
                renderProducts(PRODUCTS);
            } else {
                const filtered = PRODUCTS.filter(p => p.category === cat);
                renderProducts(filtered);
            }
        }

        // ===== POLICY TOGGLE =====
        function togglePolicy(index) {
            const content = document.querySelectorAll('.policy-content')[index];
            const icon = content.previousElementSibling.querySelector('.fa-chevron-down');
            content.classList.toggle('active');
            icon.style.transform = content.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0)';
        }

       // ===== CONTACT FORM (Final & Clean) =====
        document.getElementById('contactForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            const data = new FormData(this);
            
            // Sending data to Formspree
            fetch("https://formspree.io/f/xlgdnggr", { 
                method: "POST", 
                body: data, 
                headers: { 'Accept': 'application/json' } 
            })
            .then(r => { 
                if(r.ok) { 
                    showNotification('Message sent successfully!'); 
                    this.reset(); 
                } else { 
                    showNotification('Error sending message'); 
                } 
            })
           .catch(() => showNotification('Error sending message'));
        });

        // ===== OVERLAY CLICK HANDLER =====
        document.getElementById('overlay').addEventListener('click', function() {
            closeCart();
            closeCheckout();
            closeProductModal();
        });

        // ===== HANDLE URL PARAMETERS (FIXED) =====
        function handleURLParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('product');
            const view = urlParams.get('view');
            
            // Clear URL parameters after reading
            const cleanUrl = window.location.origin + window.location.pathname;
            window.history.replaceState({}, document.title, cleanUrl);
            
            if (productId) {
                const id = parseInt(productId);
                const product = PRODUCTS.find(p => p.id === id);
                if (product) {
                    switchView('shop');
                    setTimeout(() => openProductModal(id), 100);
                }
            } else if (view) {
                switchView(view);
            }
        }

        // ===== INITIALIZE =====
        document.addEventListener('DOMContentLoaded', function() {
            // Performance optimization: Load products after a small delay
            setTimeout(() => {
                renderProducts();
                updateCartCount();
                handleURLParameters();
            }, 50);
            
            // Fix for Home link
            document.querySelector('.nav-link[onclick*="home"]').addEventListener('click', function() {
                switchView('home');
            });
        });
    </script>
</body>
</html>



